{% extends 'oscar/dashboard/layout.html' %}
{% load category_tags %}

{% block body_class %}{{ block.super }} create-page catalogue{% endblock %}

{% block title %}
    {{ title }} | Группы персонала | {{ block.super }}
{% endblock %}

{% block breadcrumbs %}
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item">
                <a href="{% url 'dashboard:index' %}">Главная</a>
            </li>
            <li class="breadcrumb-item">
                <a href="{% url 'dashboard:groups' %}">Группы персонала</a>
            </li>
            <li class="breadcrumb-item active" aria-current="page">
                {{ title }}
            </li>
        </ol>
    </nav>
{% endblock %}

{% block navtext %}Создание группы персонала{% endblock %}

{% block dashboard_content %}
    <form class="form-stacked wysiwyg fixed-actions" method="post" data-behaviour="tab-nav-errors">
        {% csrf_token %}

        <div class="row">
            <div class="col-md-12">
                <div class="tab-content">
                    {% block group_details %}
                        <div class="tab-pane active" id="group_details">
                            <div class="table-header">
                                <h3>Описание группы персонала</h3>
                            </div>
                            <div class="card card-body bg-light option-details">

                                {% if form.non_field_errors %}
                                    {% for error in form.non_field_errors %}
                                        <div class="alert alert-danger">
                                            <span class="error-block"><i class="fas fa-exclamation"></i> {{ error }}</span>
                                        </div>
                                    {% endfor %}
                                {% endif %}

                                {% comment %} {% for field in form %} {% endcomment %}
                                {% comment %} {% endfor %} {% endcomment %}
                                
                                {% include 'oscar/dashboard/partials/form_field.html' with field=form.name %}
                                
                                {% for app_label, permissions in form.permissions.field.choices %}
                                <fieldset>
                                  <legend>{{ app_label }}</legend>
                                  {% for permission_id, permission_name in permissions %}
                                    <div>
                                      <label>
                                        <input type="checkbox" name="permissions" value="{{ permission_id }}" 
                                        {% if permission_id in form.permissions.value %}checked{% endif %}>
                                        {{ permission_name }}
                                      </label>
                                    </div>
                                  {% endfor %}
                                </fieldset>
                              {% endfor %}


                            </div>
                        </div>
                    {% endblock %}
                </div>
            </div>
        </div>
        {% block fixed_actions_group %}
            <div class="fixed-actions-group">
                <div class="d-flex justify-content-end">  
                    <a class="btn btn-danger mr-2"  href="#" {% if not is_popup %}onclick="window.history.go(-1);return false"{% else %}onclick="window.close();return false;"{% endif %}>
                        <i class="fa-regular fa-circle-xmark"></i> 
                        Отменить
                    </a>             
                    <button type="submit" class="btn btn-primary" data-loading-text="Сохранение...">
                        <i class="fa-solid fa-floppy-disk"></i>
                        Сохранить
                    </button>
                </div>
            </div>
        {% endblock fixed_actions_group %}
        
    </form>

{% endblock dashboard_content %}
